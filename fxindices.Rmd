---
title: "FX Indices"
author: "Ulrich Leuchtmann"
date: "2019-05-28"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Currency Universe and Data Download

### Currency Universe

We define the FX indices as a price system over an exchange rate universe
consisting of currencies with the following properties:

- They have a non-zero amount in OTC currency turnover,
  as measured in the [latest BIS Triennial Report](https://www.bis.org/statistics/d11_3.pdf).
- They are traded on 24-hours offshore markets,
  which in general implies the absense of forward-market restrictions.
- They are classified as "free floating", "floating",
  "crawl-like arrangement", or "stabilized arrangement"
  by the IMF in their [latest Annual Report on Exchange Arrangements and Exchange Restrictions](https://www.imf.org/~/media/Files/Publications/AREAER/areaer-2017-overview.ashx)

In case of the renminbi, we use `CNH` instead of `CNY` to ensure proper 24h quotations.

According to this rule, the currency universe consists of
the following currencies:
USD, EUR, JPY, GBP, AUD, CAD, 
CHF, CNH, SEK, NZD, MXN, 
SGD, NOK, TRY, RUB, ZAR, 
PLN, THB, HUF, CZK, ILS, 
RON.

As exchange rates we use USD rate, 
which usually are more liquid than cross rates.
I.e. the analysis is based on the following exchange rates:

```{r exrates}
exrates <- c("EURUSD", "USDJPY", "GBPUSD", "AUDUSD", "USDCAD", 
             "USDCHF", "USDCNH", "USDSEK", "NZDUSD", "USDMXN", 
             "USDSGD", "USDNOK", "USDTRY", "USDRUB", "USDZAR", 
             "USDPLN", "USDTHB", "USDHUF", "USDCZK", "USDILS", 
             "USDRON")
```

### Data Download
For all these exchange rates, data
are taken from `FX.RData`.
This file is generated by `Bbg2FXdata.R`.

Due to data limitations (`USDRUB` is the most limiting), we cannot start 
before `2014-12-18 17:30`.

A dummy exchange rate `USDUSD` is created, consisting of constant `1.0`. 
This exchange rate is used for symmetry reasons: everywhere below, 
all currencies are treated symmetrically.

Times with missing values are dropped.

```{r datadownload}
library(timeSeries)
load("FX.RData")
FX <- window(cbind(timeSeries(rep(1.0, nrow(FX)), time(FX)), 
                   FX[, exrates]),
             "2014-12-18 17:30", end(FX))
names(FX)[1] <- "USDUSD"
FX <- FX[complete.cases(FX), ]
```

## Calculation Steps for the Currency Indices

### Convert to European Quotation

Convert to European quotation 
(i.e. the amount of non-US currency that buys 1 USD)
and change names accordingly.

```{r e_quote}
for(j in c("EURUSD", "GBPUSD", "AUDUSD", "NZDUSD")){
  FX[, j] <- 1.0 / FX[, j]
  names(FX)[names(FX) == j] <- paste0(substr(j, 4, 6), substr(j, 1, 3))
}
```

### Scaling

```{r scaling}
scaleDate <- "2018-09-03 17:30"
FX.sc <- scale(FX, center = FALSE, scale = as.vector(FX[scaleDate, ]))
```

### Orthonormalization

```{r orthonormalization}
vnorm <- function(x) norm(as.matrix(x))
FX.norms <- apply(FX.sc, 1, vnorm)
for(j in 1:ncol(FX.sc)) FX.sc[, j] <- FX.sc[, j] / FX.norms
names(FX.sc) <- substr(names(FX.sc), 4, 6)
```

### Create scaled indices

```{r indices}
FX.ind <- scale(FX.sc, center=FALSE, scale = as.vector(FX.sc[scaleDate, ]))
FX.ind <- 100.0 / FX.ind
```

